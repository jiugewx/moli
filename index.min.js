!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("mobx"),require("react")):"function"==typeof define&&define.amd?define(["exports","mobx","react"],e):e(t.Moli={},t.mobx,t.React)}(this,function(t,e,n){"use strict";function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t[e],r=h[e],i=o?!0===n?function(){r.apply(this,arguments),o.apply(this,arguments)}:function(){o.apply(this,arguments),r.apply(this,arguments)}:r;t[e]=i}function r(t,e){if(null==t||null==e||"object"!==(void 0===t?"undefined":a(t))||"object"!==(void 0===e?"undefined":a(e)))return t!==e;var n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(var o=void 0,r=n.length-1;o=n[r];r--)if(e[o]!==t[o])return!0;return!1}function i(t){var e=t;if(!("function"!=typeof e||e.prototype&&e.prototype.render||e.isReactClass||c.Component.isPrototypeOf(e))){var o=function(t){function n(){return s(this,n),d(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return l(n,t),f(n,[{key:"render",value:function(){return e.call(this,this.props,this.context)}}]),n}(n.Component);return o.displayName=e.displayName||e.name,o.contextTypes=e.contextTypes,o.propTypes=e.propTypes,o.defaultProps=e.defaultProps,i(o)}if(!e)throw new Error("Please pass a valid component to 'observer'");return u(e.prototype||e),e.isMobXReactObserver=!0,e}function u(t){o(t,"componentWillMount",!0),["componentDidMount","componentWillUnmount","componentDidUpdate"].forEach(function(e){o(t,e)}),t.shouldComponentUpdate||(t.shouldComponentUpdate=h.shouldComponentUpdate)}var c="default"in n?n.default:n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),p=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},l=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h={componentWillMount:function(){function t(t){var n=this[t],o=new e.Atom("reactive "+t);Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get:function(){return o.reportObserved(),n},set:function(t){!a&&r(n,t)?(n=t,u=!0,o.reportChanged(),u=!1):n=t}})}var n=this,o=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",i=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID,u=!1,a=!1;t.call(this,"props"),t.call(this,"state");var s=this.render.bind(this),f=null,p=!1,l=function(){p=!1;var t=void 0;return f.track(function(){try{t=e.extras.allowStateChanges(!1,s)}catch(t){throw t}}),t};this.render=function(){return f=new e.Reaction(o+"#"+i+".render()",function(){if(!p&&(p=!0,"function"==typeof n.componentWillReact&&n.componentWillReact(),!0!==n.__$mobxIsUnmounted)){var t=!0;try{a=!0,u||c.Component.prototype.forceUpdate.call(n),t=!1}finally{a=!1,t&&f.dispose()}}}),l.$mobx=f,n.render=l,l()}},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,e){return this.state!==e||r(this.props,t)}};i(function(t){return(0,t.children)()}).propTypes={children:function(t,e,n,o,r){if("function"!=typeof t[e])return new Error("Invalid prop `"+r+"` of type `"+a(t[e])+"` supplied to `"+n+"`, expected `function`.")}};var b=function(t){return void 0===t},y=function(t){return"[object Array]"===Object.prototype.toString.call(t)},m=function(t){return!y(t)&&"object"===(void 0===t?"undefined":a(t))},v=function t(e){var n=null;if(y(e)){n=[];for(var o=0;o<e.length;o++)n.push(t(e[o]))}else if(m(e)){n={};for(var r in e)n[r]=t(e[r])}else n=e;return n},g=function t(e){s(this,t),Object.defineProperty(this,"$schema",{configurable:!0,enumerable:!0,writable:!1,value:v(e)}),j(this,this.$schema.state),_(this,this,this.$schema.getters),O(this,this,this.$schema.actions)},j=function(t,n){if(void 0===n)return t;if("object"!==(void 0===n?"undefined":a(n)))return console.warn("state must be a object!"),t;for(var o in n)e.extendObservable(t,p({},o,n[o]))},_=function(t,n,o){if(void 0===o)return t;for(var r in o)!function(r){e.extendObservable(t,p({},r,e.computed(function(){return o[r].apply(n,arguments)})))}(r)},O=function(t,n,o){if(void 0===o)return t;for(var r in o)!function(r){t[r]=e.action.bound(function(){return o[r].apply(n,arguments)})}(r)},w=function(t){Object.defineProperty(t,"MoliInjector",{configurable:!0,enumerable:!0,writable:!1,value:!0})},x=function(){function t(){s(this,t),this.store={}}return f(t,[{key:"createModel",value:function(t){var e=new g(t);if(e instanceof g)return this.store["$"+t.name]=e,e;throw Error("you should append a object which is Instance of Model!")}},{key:"createStore",value:function(t){if(b(t)||!m(t))return this.store;for(var e in t)t[e].name=e,this.store["$"+e]=new g(t[e]);return this.store}},{key:"getStore",value:function(){return this.store}},{key:"inject",value:function(t){var e=this;if("function"==typeof t){var o=t;return this._getInjectComponent(o)}return function(o){return o?e._getInjectComponent(o,t):e._getInjectComponent(n.Component,t)}}},{key:"binding",value:function(t){var n=this;return function(o){if(b(t)||!m(t))throw Error("this `private` function should accept a object as arguments");var r=n._getObserveClass(o),i=function(e){function n(e,o){s(this,n);var r=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,o));return r.$state=Object.assign(new function t(e){s(this,t),j(this,e.state),_(this,this,e.getters),O(t.prototype,this,e.actions)}(t),r),r}return l(n,r),n}(),u=t.actions;for(var c in u)!function(t){i.prototype[t]=e.action.bound(function(){return u[t].apply(this.$state,arguments)})}(c);return w(i),i}}},{key:"_getModel",value:function(t){return t instanceof g?t:"string"==typeof t&&this.store["$"+t]?this.store["$"+t]:null}},{key:"_getMobxProps",value:function(t){var e={};if("string"==typeof t){var n=this._getModel(t);e["$"+n.$schema.name]=n}if(y(t))for(var o=0;o<t.length;o++){var r=this._getModel(t[o]);e["$"+r.$schema.name]=r}return e}},{key:"_getObserveClass",value:function(t){var e=t;return t.MoliInjector||(e=i(t)),e}},{key:"_getInjectComponent",value:function(t,e){var n=this,o=this._getObserveClass(t);return b(e)?o.defaultProps=Object.assign(n.store,o.defaultProps):o.defaultProps=Object.assign(n._getMobxProps(e),o.defaultProps),w(o),o}}]),t}(),P=new x,C=P.binding.bind(P),M=P.inject.bind(P),$=P.createModel.bind(P),I=P.getStore.bind(P),k=P.createStore.bind(P);t.Moli=x,t.binding=C,t.inject=M,t.createModel=$,t.getStore=I,t.createStore=k,t.default=P,Object.defineProperty(t,"__esModule",{value:!0})});
