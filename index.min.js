!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("mobx")):"function"==typeof define&&define.amd?define(["exports","react","mobx"],e):e(t.Moli={},t.React,t.mobx)}(this,function(t,e,n){"use strict";function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t[e],r=_[e],i=o?!0===n?function(){r.apply(this,arguments),o.apply(this,arguments)}:function(){o.apply(this,arguments),r.apply(this,arguments)}:r;t[e]=i}function r(t,e){if(null==t||null==e||"object"!==(void 0===t?"undefined":s(t))||"object"!==(void 0===e?"undefined":s(e)))return t!==e;var n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(var o=void 0,r=n.length-1;o=n[r];r--)if(e[o]!==t[o])return!0;return!1}function i(t){var n=t;if(!("function"!=typeof n||n.prototype&&n.prototype.render||n.isReactClass||a.Component.isPrototypeOf(n))){var o=function(t){function e(){return f(this,e),d(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,t),p(e,[{key:"render",value:function(){return n.call(this,this.props,this.context)}}]),e}(e.Component);return o.displayName=n.displayName||n.name,o.contextTypes=n.contextTypes,o.propTypes=n.propTypes,o.defaultProps=n.defaultProps,i(o)}if(!n)throw new Error("Please pass a valid component to 'observer'");return u(n.prototype||n),n.isMobXReactObserver=!0,n}function u(t){o(t,"componentWillMount",!0),["componentDidMount","componentWillUnmount","componentDidUpdate"].forEach(function(e){o(t,e)}),t.shouldComponentUpdate||(t.shouldComponentUpdate=_.shouldComponentUpdate)}function c(t){if(!t.injectMoliState){var e=function(e){function n(t,e){f(this,n);var o=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e));return o.$state&&j(o.$state)&&(o.$state=new C(o.$state)),o}return h(n,t),n}();return w(e.prototype,"$then",U),e.injectMoliState=!0,P(e)}return P(t)}var a="default"in e?e.default:e,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},p=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},h=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},y=function(t){return void 0===t},b=function(t){return"function"==typeof t},m=function(t){return"string"==typeof t},v=function(t){return"[object Array]"===Object.prototype.toString.call(t)},j=function(t){return!v(t)&&"object"===(void 0===t?"undefined":s(t))},g=function(t){return b(t)&&t.prototype&&!!t.prototype.render&&!!t.prototype.setState&&!!t.prototype.forceUpdate},O=function t(e){var n=null;if(v(e)){n=[];for(var o=0;o<e.length;o++)n.push(t(e[o]))}else if(j(e)){n={};for(var r in e)n[r]=t(e[r])}else n=e;return n},w=function(t,e,n){Object.defineProperty(t,e,{enumerable:!1,value:n,writable:!1,configurable:!1})},_={componentWillMount:function(){function t(t){var e=this[t],o=new n.Atom("reactive "+t);Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get:function(){return o.reportObserved(),e},set:function(t){!c&&r(e,t)?(e=t,u=!0,o.reportChanged(),u=!1):e=t}})}var e=this,o=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",i=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID,u=!1,c=!1;t.call(this,"props"),t.call(this,"state");var s=this.render.bind(this),f=null,p=!1,l=function(){p=!1;var t=void 0;return f.track(function(){try{t=n.extras.allowStateChanges(!1,s)}catch(t){throw t}}),t};this.render=function(){return f=new n.Reaction(o+"#"+i+".render()",function(){if(!p&&(p=!0,"function"==typeof e.componentWillReact&&e.componentWillReact(),!0!==e.__$mobxIsUnmounted)){var t=!0;try{c=!0,u||a.Component.prototype.forceUpdate.call(e),t=!1}finally{c=!1,t&&f.dispose()}}}),l.$mobx=f,e.render=l,l()}},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,e){return this.state!==e||r(this.props,t)}},P=function(t){var e=t;return t.isMobXReactObserver||(e=i(t)),e};i(function(t){return(0,t.children)()}).propTypes={children:function(t,e,n,o,r){if("function"!=typeof t[e])return new Error("Invalid prop `"+r+"` of type `"+s(t[e])+"` supplied to `"+n+"`, expected `function`.")}};var $=function t(e){if(f(this,t),!j(e))throw Error("[moli] Model need argument which type is a Object");Object.defineProperty(this,"$schema",{configurable:!0,enumerable:!0,writable:!1,value:O(e)}),x(this,this.$schema.state),S(this,this,this.$schema.computed),M(this,this,this.$schema)},x=function(t,e){if(void 0===e)return t;if("object"!==(void 0===e?"undefined":s(e)))return console.warn("state must be a object!"),t;for(var o in e)n.extendObservable(t,l({},o,e[o]))},S=function(t,e,o){if(y(o))return t;for(var r in o)!function(r){n.extendObservable(t,l({},r,n.computed(function(){return o[r].apply(e,arguments)})))}(r)},M=function(t,e,o){if(y(o))return t;for(var r in o)!function(r){var i=o[r];b(i)&&Object.defineProperty(t,r,{enumerable:!1,value:n.action.bound(function(){return i.apply(e,arguments)}),writable:!1,configurable:!0})}(r)},C=function t(e){f(this,t),x(this,e)},U=function(t){var e=this,o=arguments;setTimeout(function(){(t=n.action.bound(t)).apply(e,o)},0)},k=function(t){if(g(t))return c(t);if(y(t)||!j(t))throw Error("this `bound` function should accept a object or a React.Component as arguments");return function(e){var o=c(e),r=function(e){function n(e,o){f(this,n);var r=d(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,o)),i=function t(e){f(this,t),x(this,e.state),S(this,this,e.computed),M(t.prototype,this,e)};return w(i.prototype,"$then",U),r.$state=Object.assign(new i(t),r),r}return h(n,o),n}();for(var i in t)!function(e){b(t[e])&&w(o.prototype,e,n.action.bound(function(){return t[e].apply(this.$state,arguments)}))}(i);return r}};k.action=n.action.bound;var I=new(function(){function t(){f(this,t)}return p(t,[{key:"createStore",value:function(t){if(y(t)||!j(t))throw Error("[moli] createStore need argument which type is a Object");for(var e in t){var n=t[e];this["$"+e]=new $(n)}return this}},{key:"getStore",value:function(){return this}},{key:"getModel",value:function(t){return m(t)&&this["$"+t]?this["$"+t]:null}},{key:"getModelProps",value:function(t){var e={};if(y(t))return this;if(m(t)){var n=this.getModel(t,this);e["$"+t]=n}if(v(t))for(var o=0;o<t.length;o++){var r=this.getModel(t[o],this);e["$"+t[o]]=r}return e}},{key:"InjectProps",value:function(t,e){var n=c(t),o=this.getModelProps(e);return n.defaultProps=Object.assign(o,n.defaultProps),n}}]),t}()),E=I.createStore.bind(I),R=I.InjectProps.bind(I);t.bound=k,t.inject=function(t){return g(t)?R(t):function(n){return n?R(n,t):R(e.Component,t)}},t.createStore=E,t.useStrict=n.useStrict,Object.defineProperty(t,"__esModule",{value:!0})});
